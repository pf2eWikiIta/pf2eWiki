<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Equipaggiamento</title>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <link rel="stylesheet" href="wiki.css">
    <style>
        .sezioneT { display: none; }
        .attivaT { display: block; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg bg-light fixed-top shadow-sm">
        <div class="container-fluid">
        <a class="navbar-brand" href="/index.html">
            <img src="/favicon.ico" alt="Home" width="30" height="24">
        </a>
        <span class="navbar-brand mb-0 h1">EQUIPAGGIAMENTO</span>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
            <div class="navbar-nav">
                <button class="btn btn-outline-success me-2" onclick='cambiaSezione("armature")'>Armature</button>
                <button class="btn btn-outline-success me-2" onclick='cambiaSezione("armi")'>Armi</button>
                <button class="btn btn-outline-success me-2" onclick='cambiaSezione("scudi")'>Scudi</button>
                <button class="btn btn-outline-success me-2" onclick='cambiaSezione("oggettiAlchemici")'>Oggetti alchemici</button>
            </div>
        </div>
        </div>
    </nav>

    <button class="btn btn-primary d-lg-none" id="sidebar-toggle" data-bs-toggle="offcanvas" data-bs-target="#sidebarOffcanvas">
        â˜° Menu
    </button>

    <!-- Offcanvas Sidebar -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="sidebarOffcanvas">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title">Navigazione</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body">
            <div id="sidebar-mobile" class="bg-light p-3 border rounded shadow-sm"></div>
        </div>
    </div>
    <div class="container-fluid p-3">
        <div class="row">
            <div class="col-lg-3 d-none d-lg-block border-end p-3 vh-100 overflow-auto" id ="sidebar-desktop-container">
                <div id="sidebar-desktop"></div>
            </div>
            <div class="col-lg-9 p-3">
                <div id="armature" class="sezione">
                    <h2>Armature</h2>
                </div>
                <div id="scudi" class="sezione">
                    <h2>Scudi</h2>
                </div>
                <div id="armi" class="sezione">
                    <h2>Armi da mischia</h2>
                </div>
                <div id="oggettiAlchemici" class="sezione">
                    <h2>Oggetti alchemici</h2>
                </div>
            </div>
        </div>
    </div>
    <script>
        function cambiaSezione(sezione) {
            const Armature = document.getElementById("armature");
            const Scudi = document.getElementById("scudi");
            const Armi = document.getElementById("armi");
            const OggettiAlchemici = document.getElementById("oggettiAlchemici");

            Armature.classList.remove("attiva");
            Scudi.classList.remove("attiva");
            Armi.classList.remove("attiva");
            OggettiAlchemici.classList.remove("attiva");


            switch (sezione) {
                case "armature":
                    Armature.classList.add("attiva");
                    break;
                case "scudi":
                    Scudi.classList.add("attiva");
                    break;
                case "armi":
                    Armi.classList.add("attiva");
                    break;
                case "oggettiAlchemici":
                    OggettiAlchemici.classList.add("attiva");
                    break;
            }
        }

        function cambiaTab(sezione) {
            for(let i = 0; i < window.tipi.length; i++) {
                document.getElementById(window.tipi[i]).classList.remove("attivaT");
                if(window.tipi[i] == sezione)
                    document.getElementById(window.tipi[i]).classList.add("attivaT");
            }
        }

        
    </script>
    <script type="module">
        import * as common from './common.js';
        await common.init();
        const isMobile = window.matchMedia('(max-width: 992px)').matches;

        fetch("sidebar.html")
        .then(response => response.text())
        .then(data => {
        if (isMobile)
            common.render(document.getElementById("sidebar-mobile"), data);
        else
            common.render(document.getElementById("sidebar-desktop"),data);
        });
        common.aprireSidebar("equipaggiamento");

        fetch("tabscudi.html")
        .then(response => response.text())
        .then(data => {
            common.render(document.getElementById("scudi"), data, true);
        });

        fetch("tabarmature.html")
        .then(response => response.text())
        .then(data => {
            common.render(document.getElementById("armature"), data, true);
        });

        fetch("tabarmi.html")
        .then(response => response.text())
        .then(data => {
            // 1. Parsiamo l'HTML
            const parser = new DOMParser();
            const doc = parser.parseFromString(data, "text/html");

            // 2. Prendiamo i div singolarmente
            const divA = doc.getElementById("a");
            const divB = doc.getElementById("b");
            const divC = doc.getElementById("c");

            let contArmi = document.getElementById("armi");

            common.render(contArmi, divA.innerHTML, true);
            common.render(contArmi, "<br><h2>Armi a distanza</h2>", true);
            common.render(contArmi, divB.innerHTML, true);
            common.render(contArmi, "<br><h2>Armi combinate</h2>", true);
            common.render(contArmi, divC.innerHTML, true);
        });

        let tipi = ["Strumenti alchemici", "Piante alchemiche", "Bomba alchemica", "Elisir alchemico", "Cibo alchemico", "Droghe", "Altro", "Mostri in bottiglia", "Munizione alchemica"];
        window.tipi = tipi;
        tipi.map(t => common.render(document.getElementById("oggettiAlchemici"), `<button class="btn btn-outline-success me-2" onclick="cambiaTab('${t}')">${t}</button> `, true));
        fetch("tabalchemici.html")
        .then(response => response.text())
        .then(data => {
            const parser = new DOMParser();
            const doc = parser.parseFromString(data, "text/html");

            let contAlc = document.getElementById("oggettiAlchemici");
            for(let i = 0; i < tipi.length; i++)
                common.render(contAlc, `<div id = "${tipi[i]}" class = "sezioneT"><br><h4>${tipi[i]}</h4>${doc.getElementById(tipi[i]).innerHTML}</div>`, true);
            cambiaTab(tipi[0]);
        });

        

        const urlParams = new URLSearchParams(window.location.search);
        const sez = urlParams.get('sezione');
        
        cambiaSezione(sez == null? "armature" : sez);

        common.sBInit();
window.cerca = (valore) => {
            common.sBCerca(valore);
        };

        window.copia = (testo) => {
            common.copiaTesto(testo);
        }
    </script>
</body>
</html>