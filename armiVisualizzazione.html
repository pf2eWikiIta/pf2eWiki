<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arma</title>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <link rel="stylesheet" href="wiki.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg bg-light fixed-top shadow-sm">
        <div class="container-fluid">
        <a class="navbar-brand" href="/index.html">
            <img src="/favicon.ico" alt="Home" width="30" height="24">
        </a>
        <span class="navbar-brand mb-0 h1">EQUIPAGGIAMENTO</span>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
            <div class="navbar-nav">
                <button class="btn btn-outline-success me-2" onclick='aggiorna("./equipaggiamento.html")'>Torna indietro</button>
            </div>
        </div>
        </div>
    </nav>

    <button class="btn btn-primary d-lg-none" id="sidebar-toggle" data-bs-toggle="offcanvas" data-bs-target="#sidebarOffcanvas">
        â˜° Menu
    </button>

    <!-- Offcanvas Sidebar -->
    <div class="offcanvas offcanvas-start" tabindex="-1" id="sidebarOffcanvas">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title">Navigazione</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body">
            <div id="sidebar-mobile" class="bg-light p-3 border rounded shadow-sm"></div>
        </div>
    </div>
    <div class="container-fluid p-3">
        <div class="row">
            <div class="col-lg-3 d-none d-lg-block border-end p-3 vh-100 overflow-auto" id ="sidebar-desktop-container">
                <div id="sidebar-desktop"></div>
            </div>
            <div class="col-lg-9 p-3" id = "contenitore">
            </div>
        </div>
    </div>
    <script type="module">
        import * as common from './common.js';
        await common.init();
        const htmlSidebar = common.creaSidebar();
        const isMobile = window.matchMedia('(max-width: 767.98px)').matches;
        if (isMobile) {
        // Gestione sidebar mobile
        common.render(document.getElementById("sidebar-mobile"),htmlSidebar);
        } else {
        // Gestione sidebar desktop
        common.render(document.getElementById("sidebar-desktop"),htmlSidebar);
        }
        
        const urlParams = new URLSearchParams(window.location.search);
        const idArm = urlParams.get('id');
        common.aprireSidebar(idArm);

        let path = "./data/equipaggiamento/armi.json";
        let arm = await common.restituisciOggetto(path, idArm);
        if(arm.Tipo == "Combinata") 
            common.render(document.getElementById("contenitore"), `
                <h2>${arm.Nome}</h2>
                ${common.creaGraficaTratti(arm.Tratti)}<br>
                <strong>Tipo: </strong>${arm.Tipo}; <strong>N. mani richieste: </strong>${arm.Mani};<br>
                ${common.controllaTesto(arm.Desc)}<br><br>
                <strong>Mischia</strong><br>
                ${common.creaGraficaTratti(arm.TrattiM)}
                <strong>Danno: </strong>1d${arm.TagliaM} ${arm.TipoDanniM};<br>
                <strong>Gruppo: </strong>${arm.GruppoM};<br><br>
                <strong>Distanza</strong><br>
                ${common.creaGraficaTratti(arm.TrattiD)}
                <strong>Danno: </strong>1d${arm.TagliaD} ${arm.TipoDanniD};<br>
                ${`<strong>Portata: </strong>${arm.Raggio} ${arm.Ricarica != ""? `; <strong>Ricarica: </strong>${arm.Ricarica}`: ""}<br>`}
                <strong>Gruppo: </strong>${arm.GruppoD};
                `);
        else 
        common.render(document.getElementById("contenitore"), `
        <h2>${arm.Nome}</h2>
        ${common.creaGraficaTratti(arm.Tratti)}<br>
        <strong>Tipo: </strong>${arm.Tipo}; <strong>Categoria: </strong>${arm.Categoria}; <strong>Gruppo: </strong>${arm.Gruppo};<br>
        <strong>Danno: </strong>1d${arm.Taglia} ${arm.TipoDanni}; <strong>N. mani richieste: </strong>${arm.Mani};<br>
        ${arm.Tipo == "Dist"? `<strong>Portata: </strong>${arm.Raggio}; ${arm.Ricarica != ""? `<strong>Ricarica: </strong>${arm.Ricarica}`: ""}<br>`: ""}
        ${common.controllaTesto(arm.Desc)}
        `);

        window.aggiorna= function(url) {
            common.aggiornaUrl(url);
        }

        common.sBInit();
window.cerca = (valore) => {
            common.sBCerca(valore);
        };
        window.copia = (testo) => {
            common.copiaTesto(testo);
        }
        </script>
</body>
</html>